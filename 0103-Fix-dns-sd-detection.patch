From f146c3eace076b2e6a7737c4f6d39932ac15fe3d Mon Sep 17 00:00:00 2001
From: Colin Guthrie <colin@mageia.org>
Date: Sun, 22 Apr 2012 02:37:38 +0100
Subject: [PATCH 103/105] Fix dns-sd detection

---
 mythtv/configure | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/mythtv/configure b/mythtv/configure
index 8551480..a7da12f 100755
--- a/mythtv/configure
+++ b/mythtv/configure
@@ -5479,7 +5479,16 @@ fi
 enabled libcrypto && check_lib openssl/rsa.h RSA_new -lcrypto || disable libcrypto
 
 if test $target_os != darwin ; then
-    enabled libdns_sd && check_lib dns_sd.h DNSServiceRegister -ldns_sd || disable libdns_sd
+    if enabled libdns_sd; then
+        check_lib dns_sd.h DNSServiceRegister -ldns_sd || disable libdns_sd
+        if disabled libdns_sd && pkg-config --exists avahi-compat-libdns_sd ; then
+            enable libdns_sd
+            dns_sd_flags=`pkg-config --cflags avahi-compat-libdns_sd`
+            add_cflags $dns_sd_flags
+            add_cxxflags $dns_sd_flags
+            check_lib dns_sd.h DNSServiceRegister `pkg-config --libs avahi-compat-libdns_sd` || disable libdns_sd
+        fi
+    fi
 fi
 
 if enabled libxml2 ; then
-- 
1.8.4

